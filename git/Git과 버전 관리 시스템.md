# Git 기초

> Git은 분산 버전 관리 시스템(Version Control System)이다.

정의가 다소 어렵다. 우선 이 글에서는 위 문장에 있는 ‘버전 관리 시스템’에 대해 정리할 것이며, 다음으로 Git의 작동 원리를 문장으로 설명할 것이다. 마지막으로 작동 원리를 바탕으로 명령어를 정리하여 Git을 사용할 수 있는 방법을 알아볼 것이다.

---

## 버전 관리 시스템

1. 정의

    > 버전 관리 시스템(VCS)은 파일 변화를 시간에 따라 기록했다가 나중에 특정 시점의 버전을 다시 꺼내올 수 있는 시스템이다.

    쉽게 말해서 파일의 변경점을 관리해주는 프로그램이다.

2. 장점

    VCS를 사용하면 파일을 시간에 따라 기록해두었기 때문에, 파일을 잃어버렸거나 망가뜨렸을 때, 파일을 이전 상태로 쉽게 되돌리거나 이전 상태와 비교 할 수 있다. 또한 협업 과정에서 파일을 변경한 사람과 시기를 조회할 수 있다.

3. 종류

    1. **로컬 버전관리** (Local VCS)

        서버 없이 로컬 컴퓨터 안에 데이터베이스를 만들어서 버전 관리를 한다.

        <img src="/git/Untitled.png"/>

    2. **중앙집중식 버전관리** (Centralized VCS)

        서버가 별도로 있고, 파일을 수정하려는 사람이 수정하려는 파일만 로컬 컴퓨터에 다운받아 작업한 후 서버에 업로드한다.

        <img src="/git/Untitled1.png"/>

        중앙집중식의 가장 치명적인 단점은 업로드를 받는 서버에 있다. 서버에 문제가 발생하면 그 동안 작업을 할 수 없으며, 서버가 날아가면 각각의 컴퓨터에 있는 ‘수정하려는 파일’을 제외한 모든 프로젝트가 백지화 될 수 있다.

        또한 여러 사람이 같은 파일을 수정하면 충돌이 발생할 수 있다.

    3. **분산 버전관리** (Distributed VCS)

        이 글의 주제인 Git이 이에 속한다.

        서버가 별도로 있는 것은 중앙집중식과 동일하지만, 파일을 수정하려는 사람이 프로젝트 전체를 로컬 컴퓨터에 복제하여 작업한다는 차이점이 있다. 즉, 전체 작업 파일을 내 컴퓨터에 다운받는 것이다.

        <img src="/git/Untitled2.png"/>

        때문에 서버에 문제가 발생해도 복제된 파일을 이용해 작업을 지속할 수 있으며, 파일을 수정하고 있는 모든 사람이 각각의 로컬 컴퓨터에 프로젝트를 복제했기 때문에 최종적으로 서버에 올릴 때만 신경 쓰면 수정 시 충돌의 가능성이 크게 줄어든다.

---

## Git 이해

1. **구조**

    1. 앞서 언급했듯이 Git은 ‘분산 버전관리 시스템’ 의 일종이기 때문에, Git은 로컬 저장소라는 이름으로 전체 프로젝트를 작업 폴더에 넣어서 관리한다. 이로 인해 얻는 이점은 다음과 같다.
        1. 굉장히 빠른 속도를 가진다.
        2. 네트워크를 이용하지 않기 때문에 서버에서 새 파일을 받는 것을 제외한 거의 모든 작업을 오프라인에서 할 수 있다.
        3. 당연히 서버에 일시적인 문제가 있어도 작업을 지속할 수 있다.
    2. 작업이 끝나면 Git 원격 저장소에 push(발행)하는데, 로컬 저장소에서의 작업이 끝나면 파일을 메인 저장소와 합치기 전에 Branch(가지)라는걸 이용해 각 Branch의 작업이 완료될 시 메인 저장소와 merge(합치다) 한 후 Branch를 제거하는 ‘가지치기’ 작업이 가능하다.

        ‘가지치기’ 기능 자체를 지원하는 툴은 많지만, Git은 이 기능을 굉장히 가볍고 빠르게 수행한다고 한다.

2. **흐름**

    1. 저장소 생성

        1. 새로운 Git repository를 생성한다.
        2. 존재하는 Git repository를 복제한다.

        위 두가지 방법 중 하나로 Git 저장소를 생성한다.

        - 로컬 저장소는 Git 치하의 세 단계로 구성되어있다. ←중요!
            - Working directory, 실제 파일로 이루어진다. (Modified 상태)
            - index(staging area), 준비 영역 역할을 한다. (Staged 상태)
              스테이징으로 불리며, commit 전에 파일의 변경 사항을 확인하고 commit할 파일을 선택할 수 있다.
            - HEAD, commit(확정)된 파일이다. (Committed 상태)

    2. add(추가) 와 commit

        1. 작업한 파일을 index에 추가한다.
        2. index에 있는 변경 내용을 commit한다.

        다음 과정을 통해 HEAD에 작업한 파일을 집어넣었다. 하지만 HEAD까지도 아직 로컬 저장소 안에 있다.

    3. 원격 저장소로 이동

        push한다. 이때 저장소를 만들 때 같이 생긴 master branch를 기반으로 가지치기를 할 수 있다. 즉, 다른 branch를 이용해서 작업을 하고 마지막에 master branch에 merge하는 것이다.

        이렇게 생성한 branch를 원격 저장소에 push하기 전에는 다른 사람들이 branch에 접근할 수 없다. 따라서 branch는 작업자들이 서로의 작업물을 침범하지 않고 독립적으로 동시에 작업할 수 있게끔 해준다.

    4. pull(갱신) 과 merge

        로컬 저장소를 원격 저장소에 맞춰 merge할 수 있다. 이때, 원격 저장소의 변경 내용이 자동으로 로컬 저장소에 fetch(받아지다)되고 merge된다.

        또한 다른 branch의 변경 내용을 받아와서 현재 branch에 merge할 수 있다.

        하지만 항상 merge가 성공하는 것은 아니고, 드물게 conflicts(충돌)이 발생하기도 한다. 이때 Git이 어느 부분에서 conflicts이 생겼는지 알려주며 이를 직접 고쳐서 merge가 되도록 해야 한다.

---

## Git 사용

1. 로컬 저장소

    1. 새 로컬 저장소를 만든다.

        ```
        git init
        ```

    2. 로컬/원격 저장소를 clone 한다.

        ```
        git clone [경로]
        ```

        ```
        git clone [사용자명]@[호스트]:[경로]
        ```

2. HEAD 관련

    1. 작업한 파일을 index에 추가한다.

        ```
        git add [파일명]
        ```

        ```
        git add .
        ```

    2. 변경 내용을 commit한다.

        ```
        git commit -m [설명]
        ```

3. 원격 저장소

    1. 기존의 원격 저장소를 clone한 것이 아닐 때, 원격 저장소의 주소를 Git에게 알려준다.

        ```
        git remote add origin [주소]
        ```

    2. HEAD에 있는 파일을 원격 저장소로 보낸다.

        ```
        git push origin [branch명 | master]
        ```

4. branch 관련

    1. branch의 목록을 확인한다

        ```
        git branch
        ```

    2. branch를 생성한다.

        ```
        git branch [branch명]
        ```

    3. (branch를 생성하고) 그 branch로 이동한다.

        ```
        git checkout (-b) [branch명 | master]
        ```

    4. branch를 삭제한다.

        ```
        git checkout -d [branch명]
        ```

    5. branch를 원격 저장소로 보낸다.

        ```
        git push origin [branch명]
        ```

5. 갱신

    로컬 저장소를 원격 저장소(의 특정 branch)에 맞춰 pull한다.

    ```
    git pull (origin [branch명])
    ```

6. 병합

    1. 변경사항을 확인할 수 있다.

        ```
        git diff [branch명] [비교 대상 branch명]
        ```

    2. 다른 branch의 파일을 현재 가지에 merge한다.

        ```
        git merge [branch명]
        ```

---
